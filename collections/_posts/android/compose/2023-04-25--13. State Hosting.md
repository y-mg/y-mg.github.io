---
layout: post
title: "State Hosting"
date: 2023-04-25T00:00:00Z
authors: ["y-mg"]
categories: [Android, Jetpack]
description: "Use Compose - State Hosting"
thumbnail: "/assets/images/android/android-compose.png"
image: "/assets/images/android/android-compose.png"
comments: false
---

## State Hosting
***
State Hosting 은 컴포저블의 상태를 다른 컴포저블이나 호출하는 함수로 옮기는 패턴을 말하며, 이를 통해 컴포저블을 상태를 가지지 않는(stateless) 형태로 만들 수 있게 된다.
<br/>

```kotlin
@Composable
fun PyeongToSquareMeter() {
    var pyeong by rememberSaveable {
        mutableStateOf("23")
    }
    var squaremeter by rememberSaveable {
        mutableStateOf((23 * 3.306).toString())
    }

    /*
    Column(modifier = Modifier.padding(16.dp)) {
        OutlinedTextField(
            value = pyeong,
            onValueChange = {
                if (it.isBlank()) {
                    pyeong = ""
                    squaremeter = ""
                    return@OutlinedTextField
                }
                val numericValue = it.toFloatOrNull() ?: return@OutlinedTextField
                pyeong = it
                squaremeter = (numericValue * 3.306).toString()
            },
            label = {
                Text("평")
            }
        )
        OutlinedTextField(
            value = squaremeter,
            onValueChange = {},
            label = {
                Text("제곱미터")
            }
        )
    }
    */

    PyeongToSquareMeterStateless(
        pyeong = pyeong,
        squaremeter = squaremeter,
        onPyengChange = {
            if (it.isBlank()) {
                pyeong = ""
                squaremeter = ""
                return@PyeongToSquareMeterStateless
            }
            val numericValue = it.toFloatOrNull() ?: return@PyeongToSquareMeterStateless
            pyeong = it
            squaremeter = (numericValue * 3.306).toString()
        }
    )


    /**
     * 컴포즈는 상태가 업데이트 되지 않으면 값이 바뀌지 않음
     *
     * remember 는 캐시를 설정하게 되어 있는데 화면 회전과 같이 configuration 이 발생하는 경우에는
     * 유지되지 않아 rememberSaveable 를 사용해야 됨
     *
     * 저장 공간에 한계가 있기 때문에 모든 값에 rememberSaveable 를 적용 하는 것은 권장되지 않음
     *
     * UI 부분은 상태가 없게 만들고, 상태가 변경되는 코드를 따로 관리하는 것이 권장됨
     */
}

@Composable
fun PyeongToSquareMeterStateless(
    pyeong: String,
    squaremeter: String,
    onPyengChange: (String) -> Unit
) {
    Column(modifier = Modifier.padding(16.dp)) {
        OutlinedTextField(
            value = pyeong,
            onValueChange = onPyengChange,
            label = {
                Text("평")
            }
        )
        OutlinedTextField(
            value = squaremeter,
            onValueChange = {},
            label = {
                Text("제곱미터")
            }
        )
    }
}
```
- <span onClick="window.open('https://github.com/y-mg/compose-study/blob/main/Part%2002/11.%20State/app/src/main/java/com/ymg/compose/state/MainActivity.kt');" style="cursor:pointer; color: #5495ff;">원본 코드</span>